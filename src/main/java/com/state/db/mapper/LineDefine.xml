<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.state.dao.LineDefineDao">
	
	<sql id="lineDefineInfo">
		id,mcorhr,start_area as startArea,end_area as endArea,tielineloss_ as rate,sort_ AS sort,tielinetariff_ as tielinetariff,IPRO_ as ipro,JPRO_ as jpro 
	</sql>
	<select id="getLineDefine" resultType="LineDefinePo" parameterType="String">
		select <include refid="lineDefineInfo" /> from <include refid='public.model' /> CBPM_LINE_DEFINE  where mcorhr=#{mcorhr} 
	</select>
	
	<select id="getAllLine" resultType="LineDefinePo" >
		select <include refid="lineDefineInfo" /> from <include refid='public.model' /> CBPM_LINE_DEFINE order by SORT_
	</select>
	
	<select id="getAllLineByArea" resultType="LineDefinePo" parameterType="String">
		select <include refid="lineDefineInfo" /> from <include refid='public.model' /> CBPM_LINE_DEFINE 
		where 0=0 
		<if test="area!=null and area!=''">
		   and START_AREA IN (select area from <include refid='public.model' /> CBPM_AREA  where region in (select region from <include refid='public.model' /> CBPM_AREA  where area=#{area})) 
				or 
 		   END_AREA IN (select area from <include refid='public.model' /> CBPM_AREA  where region in (select region from <include refid='public.model' /> CBPM_AREA where area=#{area}))
		</if>
		order by SORT_
	</select>
	
	<select id="countLineByMcorhr" resultType="int" parameterType="String">
		select count(1) from <include refid='public.model' /> CBPM_LINE_DEFINE  where mcorhr=#{mcorhr} 
	</select>	
	
	<insert id="insertLineDefine">
		insert into <include refid='public.model' /> CBPM_LINE_DEFINE
			(id,mcorhr,start_area,end_area,tielineloss_,sort_,tielinetariff_)
		values
			(#{id},#{mcorhr},#{startArea},#{endArea},#{rate},#{sort},#{tielinetariff})
	</insert>
	
	<delete id="deleteLineDefine" parameterType="String">
		delete from <include refid='public.model' /> CBPM_LINE_DEFINE where mcorhr=#{mcorhr} 
	</delete>
	<select id="getLineNum" resultType="int">
		select count(MCORHR) from <include refid='public.model' /> CBPM_LINE_DEFINE 
	</select>	
	<select id="getLineDefineById" resultType="LineDefinePo" parameterType="String">
		select <include refid="lineDefineInfo" /> from <include refid='public.model' /> CBPM_LINE_DEFINE  where id=#{id} 
	</select>
	
	<update id="updateLineDefine" parameterType="LineDefinePo">
		update <include refid='public.model' /> CBPM_LINE_DEFINE
		<set> 
			mcorhr=#{mcorhr},
			start_area=#{startArea},
			end_area=#{endArea},
			sort_=#{sort},
			tielineloss_=#{rate},
			tielinetariff_=#{tielinetariff}
		</set> 
		where id=#{id}
	</update>
</mapper>