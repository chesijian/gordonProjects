<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.state.dao.TransTielineDao">

	<select id="getTransTielineList" resultType="TransTielinePo">
		select id_ as id,MDATE,TIELINENAME_ as tielineName,TRANSCORRIDORNAME_ AS transCorridorName,
		SORT_ AS SORT, h01,h02,h03,h04,h05,h06,h07,h08,h09,h10,h11,h12,h13,h14,h15,h16,h17,h18,h19,h20,h21,h22,h23,h24,h25,h26,h27,h28,h29,h30,h31,h32,h33,h34,h35,h36,h37,h38,h39,h40,h41,h42,h43,h44,h45,h46,h47,h48,h49,h50,h51,h52,h53,h54,h55,h56,h57,h58,h59,h60,h61,h62,h63,h64,h65,h66,h67,h68,h69,h70,h71,h72,h73,h74,h75,h76,h77,h78,h79,h80,h81,h82,h83,h84,h85,h86,h87,h88,h89,h90,h91,h92,h93,h94,h95,h96
		 from <include refid='public.model' /> CBPM_TRANSTIELINE
	</select>
	<select id="getTransTielineListByMdate" resultType="TransTielinePo">
		select id_ as id,MDATE,TIELINENAME_ as tielineName,TRANSCORRIDORNAME_ AS transCorridorName,
		SORT_ AS SORT, h01,h02,h03,h04,h05,h06,h07,h08,h09,h10,h11,h12,h13,h14,h15,h16,h17,h18,h19,h20,h21,h22,h23,h24,h25,h26,h27,h28,h29,h30,h31,h32,h33,h34,h35,h36,h37,h38,h39,h40,h41,h42,h43,h44,h45,h46,h47,h48,h49,h50,h51,h52,h53,h54,h55,h56,h57,h58,h59,h60,h61,h62,h63,h64,h65,h66,h67,h68,h69,h70,h71,h72,h73,h74,h75,h76,h77,h78,h79,h80,h81,h82,h83,h84,h85,h86,h87,h88,h89,h90,h91,h92,h93,h94,h95,h96
		 from <include refid='public.model' /> CBPM_TRANSTIELINE where mdate=#{mdate} 
		  and TIELINENAME_ in 
			 	 (select mcorhr from <include refid='public.model' /> CBPM_LINE_DEFINE t where t.START_AREA IN (select area from <include refid='public.model' /> CBPM_AREA  where region in (select region from <include refid='public.model' /> CBPM_AREA  where area=#{area})
			) 		or 
	 		t.END_AREA IN 
	 			(select area from <include refid='public.model' /> CBPM_AREA  where region in (select region from <include refid='public.model' /> CBPM_AREA  where area=#{area})
			))
	</select>
	<select id="getTree" resultType="TransTielinePo">
		select id_ as id,MDATE,TIELINENAME_ as tielineName,TRANSCORRIDORNAME_ AS transCorridorName,
		SORT_ AS SORT, h01,h02,h03,h04,h05,h06,h07,h08,h09,h10,h11,h12,h13,h14,h15,h16,h17,h18,h19,h20,h21,h22,h23,h24,h25,h26,h27,h28,h29,h30,h31,h32,h33,h34,h35,h36,h37,h38,h39,h40,h41,h42,h43,h44,h45,h46,h47,h48,h49,h50,h51,h52,h53,h54,h55,h56,h57,h58,h59,h60,h61,h62,h63,h64,h65,h66,h67,h68,h69,h70,h71,h72,h73,h74,h75,h76,h77,h78,h79,h80,h81,h82,h83,h84,h85,h86,h87,h88,h89,h90,h91,h92,h93,h94,h95,h96
		 from <include refid='public.model' /> CBPM_TRANSTIELINE where MDATE=#{dtime} 
		 
		  <if test="status!=null ">
			 and STATUS_=#{status}
		    </if>
		 
		 
		 <if test="area!=null and area!=''">
		 	 and TIELINENAME_ in 
			 	 (select mcorhr from <include refid='public.model' /> CBPM_LINE_DEFINE t where t.START_AREA IN (select area from <include refid='public.model' /> CBPM_AREA  where region in (select region from <include refid='public.model' /> CBPM_AREA  where area=#{area})
			) 		or 
	 		t.END_AREA IN 
	 			(select area from <include refid='public.model' /> CBPM_AREA  where region in (select region from <include refid='public.model' /> CBPM_AREA  where area=#{area})
			))
		 </if>
	</select>
	
	<select id="getTradeData" resultType="TransTielinePo">
		select id_ as id,MDATE,TIELINENAME_ as tielineName,TRANSCORRIDORNAME_ AS transCorridorName,
		SORT_ AS SORT, h01,h02,h03,h04,h05,h06,h07,h08,h09,h10,h11,h12,h13,h14,h15,h16,h17,h18,h19,h20,h21,h22,h23,h24,h25,h26,h27,h28,h29,h30,h31,h32,h33,h34,h35,h36,h37,h38,h39,h40,h41,h42,h43,h44,h45,h46,h47,h48,h49,h50,h51,h52,h53,h54,h55,h56,h57,h58,h59,h60,h61,h62,h63,h64,h65,h66,h67,h68,h69,h70,h71,h72,h73,h74,h75,h76,h77,h78,h79,h80,h81,h82,h83,h84,h85,h86,h87,h88,h89,h90,h91,h92,h93,h94,h95,h96
		 from <include refid='public.model' /> CBPM_TRANSTIELINE where MDATE=#{dtime} and TRANSCORRIDORNAME_ !='汇总值' and TRANSCORRIDORNAME_ !='计划值' and TRANSCORRIDORNAME_ !='原计划值'
		 
		 <if test="area!=null and area!=''">
		 	 and TIELINENAME_ in 
			 	 (select mcorhr from <include refid='public.model' /> CBPM_LINE_DEFINE t where t.START_AREA IN (select area from <include refid='public.model' /> CBPM_AREA  where region in (select region from <include refid='public.model' /> CBPM_AREA  where area=#{area})
			) 		or 
	 		t.END_AREA IN 
	 			(select area from <include refid='public.model' /> CBPM_AREA  where region in (select region from <include refid='public.model' /> CBPM_AREA  where area=#{area})
			))
		 </if>
	</select>
	
	<select id="getTransTielineById" resultType="TransTielinePo">
		select id_ as id,TIELINENAME_ as tielineName,
		SORT_ AS SORT,h01,h02,h03,h04,h05,h06,h07,h08,h09,h10,h11,h12,h13,h14,h15,h16,h17,h18,h19,h20,h21,h22,h23,h24,h25,h26,h27,h28,h29,h30,h31,h32,h33,h34,h35,h36,h37,h38,h39,h40,h41,h42,h43,h44,h45,h46,h47,h48,h49,h50,h51,h52,h53,h54,h55,h56,h57,h58,h59,h60,h61,h62,h63,h64,h65,h66,h67,h68,h69,h70,h71,h72,h73,h74,h75,h76,h77,h78,h79,h80,h81,h82,h83,h84,h85,h86,h87,h88,h89,h90,h91,h92,h93,h94,h95,h96
		 from <include refid='public.model' /> CBPM_TRANSTIELINE where ID_= #{id} 
	</select>
	<select id="getTotalTransTielineByName" resultType="TransTielinePo">
		select id_ as id,TIELINENAME_ as tielineName,
		SORT_ AS SORT,(h01+h02+h03+h04+h05+h06+h07+h08+h09+h10+h11+h12+h13+h14+h15+h16+h17+h18+h19+h20+h21+h22+h23+h24+h25+h26+h27+h28+h29+h30+h31+h32+h33+h34+h35+h36+h37+h38+h39+h40+h41+h42+h43+h44+h45+h46+h47+h48+h49+h50+h51+h52+h53+h54+h55+h56+h57+h58+h59+h60+h61+h62+h63+h64+h65+h66+h67+h68+h69+h70+h71+h72+h73+h74+h75+h76+h77+h78+h79+h80+h81+h82+h83+h84+h85+h86+h87+h88+h89+h90+h91+h92+h93+h94+h95+h96) as sumQ
		 from <include refid='public.model' /> CBPM_TRANSTIELINE where TIELINENAME_= #{tielineName} and MDATE =#{mdate} and TRANSCORRIDORNAME_ = '汇总值'
	</select>
	
	<insert id="insertTransTieline" parameterType="TransTielinePo">
	 	insert into <include refid='public.model' /> CBPM_TRANSTIELINE
	 		(ID_,MDATE,TIELINENAME_,TRANSCORRIDORNAME_,h01,h02,h03,h04,h05,h06,h07,h08,h09,h10,h11,h12,h13,h14,h15,h16,h17,h18,h19,h20,h21,h22,h23,h24,h25,h26,h27,h28,h29,h30,h31,h32,h33,h34,h35,h36,h37,h38,h39,h40,h41,h42,h43,h44,h45,h46,h47,h48,h49,h50,h51,h52,h53,h54,h55,h56,h57,h58,h59,h60,h61,h62,h63,h64,h65,h66,h67,h68,h69,h70,h71,h72,h73,h74,h75,h76,h77,h78,h79,h80,h81,h82,h83,h84,h85,h86,h87,h88,h89,h90,h91,h92,h93,h94,h95,h96) 
	 	values 
	 		(#{id},#{mdate},#{tielineName},#{transCorridorName},#{h01},#{h02},#{h03},#{h04},#{h05},#{h06},#{h07},#{h08},#{h09},#{h10},#{h11},#{h12},#{h13},#{h14},#{h15},#{h16},#{h17},#{h18},#{h19},#{h20},#{h21},#{h22},#{h23},#{h24},#{h25},#{h26},#{h27},#{h28},#{h29},#{h30},#{h31},#{h32},#{h33},#{h34},#{h35},#{h36},#{h37},#{h38},#{h39},#{h40},#{h41},#{h42},#{h43},#{h44},#{h45},#{h46},#{h47},#{h48},#{h49},#{h50},#{h51},#{h52},#{h53},#{h54},#{h55},#{h56},#{h57},#{h58},#{h59},#{h60},#{h61},#{h62},#{h63},#{h64},#{h65},#{h66},#{h67},#{h68},#{h69},#{h70},#{h71},#{h72},#{h73},#{h74},#{h75},#{h76},#{h77},#{h78},#{h79},#{h80},#{h81},#{h82},#{h83},#{h84},#{h85},#{h86},#{h87},#{h88},#{h89},#{h90},#{h91},#{h92},#{h93},#{h94},#{h95},#{h96})
	</insert>

	<delete id="deleteResultByDate">
		delete from <include refid='public.model' /> CBPM_TRANSTIELINE where mdate=#{mdate} 
	</delete>
</mapper>